<html>
<head>
    <meta charset="utf-8">
    <title>后台管理系统</title>
    <meta name="Keywords" content="网店,品牌网店,精选网购,精选旗舰店">
    <meta name="Description" content="精选品牌网店大全，为您推荐精选网店、精选旗舰店、精选品牌网店、精选全面优惠网购等信息。">
    <link rel="stylesheet" href="/admin/css/manage-system.css">
    <style>

        .nav {
            width: 100%;
            height: 100px;
            background: #0094d2;
            color: white;
            font-size: 16px;
        }

        .nav-logo {
            float: left;
            padding: 10px 20px;
        }

        .nav-logo img {
            width: 100px;
        }

        .nav ul li {
            float: left;
            padding: 40px 20px;
        }

        .nav ul li a {
            color: white;
        }

        .center {
            min-width: 1500px;
        }

        .left-nav {
            width: 181px;
            float: left;
            border: 1px solid #d5d5d5;
            font-size: 14px;
            color: #666;
            min-height: 650px;
            background-color: #fff;
            box-shadow: 0 2px 5px #ccc;
        }

        .left-nav-grade1 {
            width: 100%;
            font-weight: 700;
            height: 41px;
            line-height: 41px;
            text-indent: 20px;
            position: relative;
            background-color: #edf6f9;
            color: #999;
        }

        .left-nav-grade2 {
            text-indent: 35px;
            width: 100%;
            border-bottom: 1px solid #e7e7e7;
            line-height: 40px;
        }

        .nav-bg {
            background: #157fac;
        }

        .center-right {
            float: left;
            margin-left: 60px;
            margin-top: 30px;
        }

        .prod-operation {
            background: #0094d2;
        }

        .prod-operation a {
            color: white;
        }

        .table {
            border: 0;
            cellspacing: 0;
            cellpadding: 0;
            width: 1000px;
        }

        .table td {
            border-bottom: 1px solid #ddd;
            padding-top: 15px;
            padding-bottom: 15px;
            border-top: 1px solid #ddd;
            border-right: 1px solid #ddd;
            font-size: 13px;
        }

        .table-title {
            background-color: #f4f4f4;
            text-align: center;
            border-right: 1px solid #ddd;
            border-top: 1px solid #ddd;
        }

        .table-input {
            width: 450px;
            height: 27px;
            padding-left: 5px;
            margin-left: 20px;
        }

        .btn-group {
            margin-top: 20px;
            margin-bottom: 120px;
            text-align: center;
        }

        #save-btn {
            width: 112px;
            height: 32px;
            background-color: #333;
            color: #fff;
            line-height: 32px;
            text-align: center;
            border-radius: 2px;
            cursor: pointer;
            display: inline-block;
        }

    </style>

    <script type="text/javascript" charset="utf-8" src="ueditor.config.js"></script>
    <script type="text/javascript" charset="utf-8" src="ueditor.all.min.js"></script>
    <!--建议手动加在语言，避免在ie下有时因为加载语言失败导致编辑器加载失败-->
    <!--这里加载的语言文件会覆盖你在配置项目里添加的语言类型，比如你在配置项目里配置的是英文，这里加载的中文，那最后就是中文-->
    <script type="text/javascript" charset="utf-8" src="lang/zh-cn/zh-cn.js"></script>

    <style type="text/css">
        .clear {
            clear: both;
        }
    </style>
</head>
<body>
<div>
    <div id="navigation">
        <div class="nav">
            <div class="nav-logo">
                <img src="/admin/images/logo2.jpg">
                <div>系统管理后台</div>
            </div>
            <ul class="top-nav"></ul>
        </div>
        <div class="left-nav clearfix"></div>
    </div>

    <div class="center">
        <div class="center-right">
            <table class="table">
                <tbody>
                <tr>
                    <td class="table-title">*标题名称</td>
                    <td colspan="3">
                        <input class="table-input" type="text" name="" id="meta-title" value="">
                    </td>
                <tr>
                    <td class="table-title">*页面关键字</td>
                    <td colspan="3">
                        <input class="table-input" type="text" name="" id="meta-key" value="">
                    </td>
                </tr>
                <tr>
                    <td class="table-title">*文章摘要</td>
                    <td colspan="3">
                        <textarea class="table-input" type="text" name="" id="meta-descp" value=""></textarea>
                    </td>
                </tr>
                <tr>
                    <td class="table-title">所属类型</td>
                    <td colspan="3">
                        <div>
                            <input type="checkbox" name="articleCatalog" value="1">家居装修</input>
                            <input type="checkbox" name="articleCatalog" value="2">选购导购</input>
                            <input type="checkbox" name="articleCatalog" value="3">旅游景点</input>
                            <input type="checkbox" name="articleCatalog" value="4">娱乐趣闻</input>
                            <input type="checkbox" name="articleCatalog" value="5">健康养生</input>
                            <input type="checkbox" name="articleCatalog" value="6">日常生活</input>
                            <input type="checkbox" name="articleCatalog" value="7">母婴育儿</input>
                            <input type="checkbox" name="articleCatalog" value="8">数码科技</input>
                            <input type="checkbox" name="articleCatalog" value="9">游戏资讯</input>
                        </div>
                        <div>
                            <input type="checkbox" name="articleCatalog" value="10">服装鞋包</input>
                            <input type="checkbox" name="articleCatalog" value="11">美妆护肤</input>
                            <input type="checkbox" name="articleCatalog" value="12">城市房产</input>
                            <input type="checkbox" name="articleCatalog" value="13">金融理财</input>
                            <input type="checkbox" name="articleCatalog" value="14">汽车出行</input>
                            <input type="checkbox" name="articleCatalog" value="15">品牌热点</input>
                            <input type="checkbox" name="articleCatalog" value="16">人生指南</input>
                            <input type="checkbox" name="articleCatalog" value="17">美食菜谱</input>
                            <input type="checkbox" name="articleCatalog" value="18">奢侈时尚</input>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td class="table-title">文章标题</td>
                    <td colspan="3">
                        <input class="table-input" type="text" name="" id="title">
                    </td>
                </tr>
                <tr>
                    <td class="table-title">文章作者</td>
                    <td colspan="3">
                        <input class="table-input" type="text" name="" id="author">
                    </td>
                </tr>
                <tr>
                    <td class="table-title">封面图</td>
                    <td colspan="3">
                        <input class="table-input" type="button" name="" id="picture" value="上传图片">
                    </td>
                </tr>
                <tr>
                    <td class="table-title">文章内容</td>
                    <td colspan="3">
                        <script id="editor" type="text/plain" style="width:1024px;height:500px;"></script>
                    </td>
                </tr>
                </tbody>
            </table>

            <div class="btn-group">
                <span id="save-btn" onclick="generatorActicle()">提交</span>
            </div>
        </div>
    </div>
    <!--分页-->
    <div class="page-num"></div>
</div>

<div class="load hidden">
    <div class="loading"></div>
    <img class="loading-img" src="images/loading.gif"/>
</div>
</body>
<script src="/js/jquery.min.js"></script>
<script src="/js/jquery.form.js"></script>
<script src="/admin/js/app.js"></script>
<script src="/admin/js/systemManage.js"></script>
<script src="/admin/js/navigation.js"></script>
<script>

    UE.getEditor('editor');

    var id = getParam("id");

    function generatorActicle() {
        var param = {};
        param.metaTitle = $("#meta-title").val();
        param.metaKey = $("#meta-key").val();
        param.metaDescp = $("#meta-descp").val();
        param.title = $("#title").val();
        param.picture = $("#picture").val();
        param.author = $("#author").val();
        param.content = UE.getEditor('editor').getContent();

        var type = "";
        $('input[name="articleCatalog"]:checked').each(function () {
            type += $(this).val() + ",";
        });
        type = type.substr(0, type.length - 1);
        param.type = type;

        var contentDescp = UE.getEditor('editor').getContentTxt();
        if (contentDescp.length > 100) {
            contentDescp = contentDescp.substr(0, 95)+".....";
        }
        param.contentDescp = contentDescp;

        if(param.metaTitle==""){
            alert("标题名称不能为空");
            return;
        }
        if(param.metaKey==""){
            alert("页面关键字不能为空");
            return;
        }
        if(param.metaDescp==""){
            alert("文章摘要不能为空");
            return;
        }
        if(type==""){
            alert("所属类型不能为空");
            return;
        }
        if(param.title==""){
            alert("文章标题不能为空");
            return;
        }
        if(param.author==""){
            alert("文章作者不能为空");
            return;
        }
        if(param.content==""){
            alert("文章内容不能为空");
            return;
        }

        app.addArticle(param, function (result) {
            if (result.code == 200) {
                alert("添加文章成功");
            }
        })
    }

    $(function () {
        init();
        setTimeout(function () {
            $("#edui1").attr("style", "width: 730px; z-index: 999;");
            $("#edui1_toolbarbox").attr("style", "");
        }, 200);

    });

    function init() {
        bindEvent();
    }

    function bindEvent() {
        $(".search-btn").click(function () {
            searchInfo(1);
        });

        $(".more-delete-btn").click(function () {
            var prodId = $("#prod-id-input").val();
            var category = $("#category-input").val();
            var platform = $("#platform-input").val();
            var expirationStart = $("#expiration-start-input").val();
            var expirationEnd = $("#expiration-end-input").val();
            var createTimeStart = $("#createtime-start-input").val();
            var createTimeEnd = $("#createtime-end-input").val();

            if (prodId == "" && category == "" && platform == "" && expirationStart == "" && expirationEnd == ""
                && createTimeStart == "" && createTimeEnd == "") {
                alert("请输入删除条件");
                return;
            }
            $(".load").removeClass("hidden");
            var reqData = {};
            var param = {};
            param.prodId = prodId;
            param.category = category;
            param.platform = platform;
            param.expirationStart = expirationStart;
            param.expirationEnd = expirationEnd;
            param.createTimeStart = createTimeStart;
            param.createTimeEnd = createTimeEnd;
            param.page = 1;
            param.pageSize = 20;
            reqData.reqData = param;

            app.batchProdDelete(reqData, function (result) {
                $(".load").addClass("hidden");
                if (result.code == 200) {
                    searchInfo(1);
                    alert("删除成功");
                }
            });
        });

        $(".all-delete-btn").click(function () {
            $(".load").removeClass("hidden");

            var param = {};
            app.allProdDelete(param, function (result) {
                $(".load").addClass("hidden");
                if (result.code == 200) {
                    searchInfo(1);
                    alert("删除成功");
                }
            });
        });
    }
</script>
</html>